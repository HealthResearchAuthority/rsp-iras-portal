@using Rsp.IrasPortal.Application.Constants
@using Rsp.IrasPortal.Application.DTOs.Responses.CmsContent;

@section Breadcrumb {
    @await Html.PartialAsync("_Breadcrumb", new List<(string, string?)>())
}

@{
    var pageContentData = (Dictionary<string, MixedContentPageItem?>?)ViewData[PageContentElements.PageContent];
    var pageContent = pageContentData != null
        ? pageContentData
        : new Dictionary<string, MixedContentPageItem?>();

    var headline = pageContent.GetValueOrDefault("SponsorWorkspace.Headline", null);
    var authorisationsTitle = pageContent.GetValueOrDefault("SponsorWorkspace.AuthorisationsTitle", null);
    var authorisationsDescription = pageContent.GetValueOrDefault("SponsorWorkspace.AuthorisationsDescription", null);

    var sponsorOrganisationName = ViewBag.SponsorOrganisationName as string;
    var sponsorOrganisationUserId = ViewBag.SponsorOrganisationUserId ?? Guid.Empty;
    var filledAuthorisationsDescription = authorisationsDescription?.Value?.Replace("{sponsor organisation name}", sponsorOrganisationName);
}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
        <h1 class="govuk-heading-xl">@Html.Raw(headline?.Value)</h1>
        <partial name="_ActionItem"
            model="@(authorisationsTitle?.Value,
                     filledAuthorisationsDescription,
                     "sws:authorisations",
                     new Dictionary<string, string> { { "sponsorOrganisationUserId", sponsorOrganisationUserId.ToString() } })" />
    </div>
</div>