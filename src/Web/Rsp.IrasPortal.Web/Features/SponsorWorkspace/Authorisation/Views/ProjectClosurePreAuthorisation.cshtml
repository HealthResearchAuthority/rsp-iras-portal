@using Rsp.Portal.Application.Constants
@using Rsp.Portal.Application.DTOs.Responses.CmsContent
@using Rsp.Portal.Domain.AccessControl
@model Rsp.Portal.Web.Features.SponsorWorkspace.Authorisation.Models.AuthoriseProjectClosuresOutcomeViewModel

@{    
    var pageContentData = (Dictionary<string, MixedContentPageItem?>?)ViewData[PageContentElements.PageContent];
    var pageContent = pageContentData != null
        ? pageContentData
        : new Dictionary<string, MixedContentPageItem?>();

    var heading = pageContent.GetValueOrDefault("SponsorWorkspace.ProjectClosurePreAuthorisation.Header", null);    
    var messageText = pageContent.GetValueOrDefault("SponsorWorkspace.ProjectClosurePreAuthorisation.MessageText", null);
}

@section BackNavigation {
    <partial name="_BackNavigation" model="@("sws:checkandauthoriseprojectclosure",
                                             "Back",
                                             new Dictionary<string, string> {
                                                { "sponsorOrganisationUserId", Model.SponsorOrganisationUserId.ToString() },
                                                { "projectRecordId", Model.ProjectRecordId },
                                                { "rtsId", Model.RtsId },

                                             })" />
}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        <h1 class="govuk-heading-l">
            @Html.Raw(heading?.Value)
        </h1>
        <dl class="govuk-summary-list">
            <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">IRAS ID</dt>
                <dd class="govuk-summary-list__value">
                    @Model.IrasId
                </dd>
            </div>
            <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">Short project title</dt>
                <dd class="govuk-summary-list__value">
                    @Model.ShortProjectTitle
                </dd>
            </div>
        </dl>

        <p class="govuk-body">
            @Html.Raw(messageText?.Value)            
        </p>

        <div class="save-buttons">
            <authorized permission="@Permissions.Sponsor.ProjectClosures_Authorise">
                <form method="post">
                    @Html.AntiForgeryToken()
                    <input type="hidden" name="ProjectRecordId" value="@Model.ProjectRecordId" />
                    <input type="hidden" name="SponsorOrganisationUserId" value="@Model.SponsorOrganisationUserId" />
                    <input type="hidden" name="Outcome" value="@Model.Outcome" />
                    <input type="hidden" name="RtsId" value="@Model.RtsId" />
                    <button asp-route="sws:projectclosurepreauthorisationconfirm" type="submit" class="govuk-button govuk-button--warning" data-module="govuk-button">
                        Authorise closure
                    </button>
                </form>
            </authorized>
            <form method="get">   
                <input type="hidden" name="ProjectRecordId" value="@Model.ProjectRecordId" />
                <input type="hidden" name="SponsorOrganisationUserId" value="@Model.SponsorOrganisationUserId" />
                @{
                    ViewBag.Style = "govuk-button govuk-button--secondary";                    
                }
                <partial name="_SubmitButton"                         
                         model="@("sws:checkandauthoriseprojectclosure", "Go back to check and authorise", new Dictionary<string, string>
                         {
                             ["ProjectRecordId"] = Model.ProjectRecordId,
                             ["SponsorOrganisationUserId"] = Model.SponsorOrganisationUserId.ToString(),
                             ["RtsId"] = Model.RtsId
                         })" />
            </form>
        </div>
    </div>
</div>