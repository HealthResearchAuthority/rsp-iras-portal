@using Rsp.IrasPortal.Application.Constants
@using Rsp.IrasPortal.Application.DTOs.Responses.CmsContent
@model Rsp.IrasPortal.Web.Features.SponsorWorkspace.Authorisation.Models.AuthoriseOutcomeViewModel

@{
    string heading;
    string messageText;

    var pageContentData = (Dictionary<string, MixedContentPageItem?>?)ViewData[PageContentElements.PageContent];
    var pageContent = pageContentData != null
        ? pageContentData
        : new Dictionary<string, MixedContentPageItem?>();

    var reviewRequiredHeader = pageContent.GetValueOrDefault("SponsorWorkspace.Confirmation.ReviewRequiredHeader", null);
    var reviewRequiredMessage = pageContent.GetValueOrDefault("SponsorWorkspace.Confirmation.ReviewRequiredMessage", null);

    var noReviewRequiredHeader = pageContent.GetValueOrDefault("SponsorWorkspace.Confirmation.NoReviewRequiredHeader", null);
    var noReviewRequiredMessage = pageContent.GetValueOrDefault("SponsorWorkspace.Confirmation.NoReviewRequiredMessage", null);

    var notAuthorisedHeader = pageContent.GetValueOrDefault("SponsorWorkspace.Confirmation.NotAuthorisedHeader", null);
    var notAuthorisedMessage = pageContent.GetValueOrDefault("SponsorWorkspace.Confirmation.NotAuthorisedMessage", null);

    switch (Model.Outcome)
    {
        case "Authorised":
        {
            // Default to "No review required" if ReviewType is null/empty
            var reviewType = string.IsNullOrWhiteSpace(Model.ReviewType)
                ? "No review required"
                : Model.ReviewType;

            switch (reviewType)
            {
                case "Review required":
                    heading = reviewRequiredHeader?.Value;
                    messageText = reviewRequiredMessage?.Value;
                    break;

                case "No review required":
                default:
                    heading = noReviewRequiredHeader?.Value;
                    messageText = noReviewRequiredMessage?.Value;
                    break;
            }

            break;
        }

        case "NotAuthorised":
        default:
        {
            heading = notAuthorisedHeader?.Value;
            messageText = notAuthorisedMessage?.Value;
            break;
        }
    }
}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        <div class="govuk-panel govuk-panel--confirmation">
            <h1 class="govuk-panel__title">
                @heading
            </h1>
        </div>
        <h2 class="govuk-panel__title">
            What happens next
        </h2>

        <p class="govuk-body">
            @messageText
        </p>

        <form method="get">
            <partial name="_SubmitButton"
                     model="@("sws:authorisations", "Return to authorisations", new Dictionary<string, string>
                            {
                                ["SponsorOrganisationUserId"] = Model.SponsorOrganisationUserId.ToString()
                            })"/>

        </form>
    </div>
</div>