@using Rsp.IrasPortal.Application.Constants
@model Rsp.IrasPortal.Web.Models.PlannedEndDateOrganisationTypeViewModel

@{
    ViewData["Title"] = "Which organisation types does this change affect?";
    var pageTitle = TempData["SpecificAreaOfChangeText"] as string ?? "the selected change";
    var errorSummaryTitle = "There is a problem";

    var isReviewInProgress = TempData.Peek(TempDataKeys.ProjectModificationPlannedEndDate.ReviewChanges) is true;

    var navModel = (isReviewInProgress ? "pmc:modificationchangesreview" : "pmc:plannedenddate", "Back", new Dictionary<string, string>());
}

<div class="govuk-width-container">
    @section BackNavigation {
        <partial name="_BackNavigation" model="navModel" />
    }

    <partial name="_ValidationSummary" model="(ViewData.ModelState, errorSummaryTitle)" />

    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            <form asp-action="SubmitOrganisationTypes" method="post">

                <partial name="_ProjectModificationSummary" model="Model" />

                <div class="govuk-form-group" error-class-for="SelectedOrganisationTypes">

                    <span class="govuk-label govuk-label--m">
                        Which organisation types does this change affect?
                    </span>

                    <div class="govuk-checkboxes govuk-checkboxes--small">
                        <rsp-gds-checkbox-group asp-for="SelectedOrganisationTypes"
                                                options="Model.OrganisationTypes.Select(ot => ot.Value)"
                                                conditional-field="false"
                                                legend-class="govuk-hint"
                                                label-text="Select all that apply" />
                    </div>
                </div>

                <div class="save-buttons">

                    @{
                        var buttonText = isReviewInProgress ? "Save changes" : "Save and continue";
                    }

                    <partial name="_SubmitButton" model="@("pmc:submitorganisationtypes", buttonText, new Dictionary<string, string>())" />

                    @if (!isReviewInProgress)
                    {
                        ViewBag.Style = "govuk-button govuk-button--secondary";

                        <partial name="_SubmitButton" model="@("pmc:submitorganisationtypes", "Save for later", new Dictionary<string, string> {{ "saveForLater", bool.TrueString }})" />
                    }
                </div>

                <p><a href="#" class="govuk-link">Remove this change</a></p>
            </form>
        </div>
    </div>
</div>