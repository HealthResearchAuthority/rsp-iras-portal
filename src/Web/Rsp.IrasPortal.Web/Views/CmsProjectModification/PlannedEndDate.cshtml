@using Rsp.IrasPortal.Application.Constants
@model Rsp.IrasPortal.Web.Models.PlannedEndDateViewModel

@{
    ViewData["Title"] = "Planned End Date";
    var errorSummaryTitle = "There is a problem";

    var isReviewInProgress = TempData.Peek(TempDataKeys.ProjectModificationPlannedEndDate.ReviewChanges) is true;

    var navModel = (isReviewInProgress ? "pmc:modificationchangesreview" : "pmc:areaofchange", "Back", new Dictionary<string, string>());
}

	@section BackNavigation {
    <partial name="_BackNavigation" model="navModel" />
	}

<partial name="_ValidationSummary" model="(ViewData.ModelState, errorSummaryTitle)" />

		<div class="govuk-grid-row">
			<div class="govuk-grid-column-two-thirds">

        <form method="post">

					<partial name="_ProjectModificationSummary" model="Model" />

            <div class="govuk-!-margin-bottom-3 flex-gap-2">
                <span class="govuk-label">Current planned project end date</span>
                <span class="govuk-body govuk-!-font-weight-bold">@Model.CurrentPlannedEndDate</span>
            </div>

            <input type="hidden" asp-for="CurrentPlannedEndDate" />

            <rsp-gds-date-input id="NewPlannedEndDate.Date"
                                asp-for="NewPlannedEndDate.Date"
                                day-name="NewPlannedEndDate.Day"
                                day-value="@Model.NewPlannedEndDate.Day"
                                month-name="NewPlannedEndDate.Month"
                                month-value="@Model.NewPlannedEndDate.Month"
                                year-name="NewPlannedEndDate.Year"
                                year-value="@Model.NewPlannedEndDate.Year"
                                label-text="New planned project end date"
                                label-html-class="font-weight-none"
                                hint-html="For example, 27 March 2029" />

					<div class="save-buttons">

						@{
                    var buttonText = isReviewInProgress ? "Save changes" : "Save and continue";
                }

                <partial name="_SubmitButton" model="@("pmc:saveplannedenddate", buttonText, new Dictionary<string, string>())" />

                @if (!isReviewInProgress)
                {
							ViewBag.Style = "govuk-button govuk-button--secondary";

                    <partial name="_SubmitButton" model="@("pmc:saveplannedenddate", "Save for later", new Dictionary<string, string> {{ "saveForLater", bool.TrueString }})" />
						}
					</div>

					<p>
						<a href="#" class="govuk-link">Remove this change</a>
					</p>
				</form>
			</div>
</div>