@using Rsp.Portal.Application.Constants
@model Rsp.Portal.Web.Features.Modifications.Models.ModificationDetailsViewModel

@{    
    var queryDocuments = Context.Request.Query["documents"].ToString();    
    bool isNotOnlyApplicant = User.IsInRole(Roles.Sponsor)
                       || User.IsInRole(Roles.StudyWideReviewer)
                       || User.IsInRole(Roles.TeamManager)
                       || User.IsInRole(Roles.SystemAdministrator)
                       || User.IsInRole(Roles.OrganisationAdministrator)
                       || User.IsInRole(Roles.WorkflowCoordinator);
    
    string activeTabId =
        queryDocuments == ModificationOverview.Documents ? "documents-tab" :
        isNotOnlyApplicant ? "sponsor-details-tab" : "modifications-changes-tab";
}

<!-- Hidden controls -->
<input type="radio"
       id="tab-sponsor-details"
       role="tab"
       name="tab-toggle"
       class="govuk-tab-toggle"
       aria-label="@ModificationOverview.SponsorDetails"
       @(activeTabId == "sponsor-details-tab" ? "checked" : null)>
<input type="radio"
       id="tab-modifications-changes"
       role="tab"
       name="tab-toggle"
       class="govuk-tab-toggle"
       aria-label="@ModificationOverview.ModificationDetails"
       @(activeTabId == "modifications-changes-tab" ? "checked" : null)>
<input type="radio"
       id="tab-documents"
       role="tab"
       name="tab-toggle"
       class="govuk-tab-toggle"
       aria-label="@ModificationOverview.Documents"
       @(activeTabId == "documents-tab" ? "checked" : null)>
<input type="radio"
       id="tab-history"
       role="tab"
       name="tab-toggle"
       class="govuk-tab-toggle"
       aria-label="@ModificationOverview.History"
       @(activeTabId == "history-tab" ? "checked" : null)>

<!-- Keep the same GOV.UK Service Navigation look -->
<div class="govuk-service-navigation" aria-hidden="true">
    <div class="govuk-width-container">
        <div class="govuk-service-navigation__container">
            <nav class="govuk-service-navigation__wrapper">
                <ul class="govuk-service-navigation__list">

                    <li class="govuk-service-navigation__item small-margin govuk-service-navigation__item--sponsor-details">
                        <label for="tab-sponsor-details" class="govuk-service-navigation__link govuk-service-navigation__link-label">
                            @ModificationOverview.SponsorDetails
                        </label>
                    </li>

                    <li class="govuk-service-navigation__item small-margin govuk-service-navigation__item--modifications-changes">
                        <label for="tab-modifications-changes" class="govuk-service-navigation__link govuk-service-navigation__link-label">
                            @ModificationOverview.ModificationDetails
                        </label>
                    </li>

                    <li class="govuk-service-navigation__item small-margin govuk-service-navigation__item--documents">
                        <label for="tab-documents" class="govuk-service-navigation__link govuk-service-navigation__link-label">
                            @ModificationOverview.Documents
                        </label>
                    </li>

                    <li class="govuk-service-navigation__item small-margin govuk-service-navigation__item--history">
                        <label for="tab-history" class="govuk-service-navigation__link govuk-service-navigation__link-label">
                            @ModificationOverview.History
                        </label>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>

<!-- Panels (toggle visibility via CSS) -->
<div id="sponsor-details" class="tab-content">
    <partial name="SponsorDetails" model="Model" viewData="ViewData" />
</div>

<div id="modifications-changes" class="tab-content">
    <partial name="ModificationChanges" model="Model" viewData="ViewData" />
</div>

<div id="documents" class="tab-content">
    <partial name="SupportingDocuments" model="Model" viewData="ViewData" />
</div>

<div id="history" class="tab-content">
    <partial name="_ProjectModificationAuditTrail" model="Model.AuditTrailModel" viewData="ViewData" />
</div>